rule FireEye_Exploit_Guard_IOC {
  meta:
    author = "Jonathan Heng"
    description = "Detects FireEye alerts on IOC hits by Exploit Guard"
    severity = "MEDIUM"
    priority = "MEDIUM"
    platform = "FireEye"
    mitre_attack_tactic = "Execution"
    mitre_attack_technique = "Indicator of Compromise"
    version = "1.00"

  events:
    $e.metadata.vendor_name = "FireEye" nocase
    $e.security_result.action_details = "Detection IOC Hit"

  outcome:
    $sev_rating = array_distinct($e.security_result.severity)
    $IoC_Name = $e.additional.fields["IOC Name"]

  condition:
    $e
}
