rule CVE_2024_3400_UPSTYLE_Backdoor {
  meta:
    author = "Dennis Yap"
    description = "Detects UPSTYLE backdoor."
    reference = "https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/"
    sigma_id = "92500ba9-3c38-4e77-93cc-f740f96eeae1"
    severity = "CRITICAL"
    priority = "CRITICAL"
    tags = "attack.command_and_control, attack.t1105, cve.2024.3400"
    mitre_attack_tactic = "Command and Control"
    mitre_attack_technique = "Ingress Tool Transfer"
    version = "1.00" 

  events:
    $event.metadata.event_type = "PROCESS_LAUNCH"
    (
        $event.target.process.command_line = /\/opt\/pancfg\/mgmt\/licenses\/PA_VM|exec\(base64\./ nocase or
        $event.target.process.command_line = /signal\.signal\(signal\.SIGTERM,stop\)|exec\(base64\./ nocase or
        $event.target.process.command_line = /write\(\\"\/.*\\"\+output\+\\".*\/\\"\)|SHELL_PATTERN/ nocase
    )
    
  condition:
    $event
}
