rule CVE_2024_49113_Exploitation_Attempt_LDAP_Nightmare {
  meta:
    author = "Samuel Monsempes"
    description = "Detects exploitation attempt of CVE-2024-49113 known as LDAP Nightmare, based on \"Application Error\" log where the faulting application is \"lsass.exe\" and the faulting module is \"WLDAP32.dll\"."
    reference = "https://gist.github.com/travisbgreen/82b68bac499edbe0b17dcbfa0c5c71b7, https://www.linkedin.com/feed/update/urn:li:activity:7282295814792605698/"
    sigma_id = "3f2c93c7-7b2a-4d58-bb8d-6f39422d8148"
    severity = "HIGH"
    priority = "HIGH"
    platform = "Windows"
    mitre_attack_tactic = "Impact"
    mitre_attack_technique = "Endpoint Denial of Service"
    version = "1.00"

  events:
    $event.metadata.product_name = /Application Error/
    $event.metadata.product_event_type = "1000"
    $event.principal.process.file.full_path = /lsass.exe/ nocase
    $event.target.process.file.full_path = /WLDAP32.dll/ nocase
    
  condition: 
    $event
}
