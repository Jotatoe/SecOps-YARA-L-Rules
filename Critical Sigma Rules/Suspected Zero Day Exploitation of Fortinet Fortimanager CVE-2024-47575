rule Suspected_Zero_Day_Exploitation_of_Fortinet_Fortimanager_CVE_2024_47575 {
  meta:
    author = "Dennis Yap"
    description = "Detects (1) attacker-controlled FortiGate devices under the name \"localhost\", which will appear in the Unregistered Devices section in Fortimanager; (2) modification of \"localhost\" device settings."
    reference = "https://cloud.google.com/blog/topics/threat-intelligence/fortimanager-zero-day-exploitation-cve-2024-47575/"
    sigma_id = "5e52101a-7b0c-49f1-bb5a-2854194009a4"
    severity = "CRITICAL"
    priority = "CRITICAL"
    platform = "Fortimanager"
    tags = "attack.initial_access, attack.t1190, cve.2024.47575"
    title = "Suspected Zero Day Exploitation of Fortinet FortiManager (CVE-2024-47575)"
    falsepositives = "Unknown" 

  events:
    $event.additional.fields["Message"] = /Unregistered device localhost add succeeded|FMG-VMTM23017412|Added unregistered device to unregistered table|FMG-VMTM19008093/ nocase
    
  condition: 
    $event
}
